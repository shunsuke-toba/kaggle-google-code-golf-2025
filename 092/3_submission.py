p=lambda g,h=():[*zip(*[[sum({*r[:i]}&{*r[i:]})or c for i,c in enumerate(r)]for r in h or p(g,g)])]