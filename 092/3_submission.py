f=lambda a:[*zip(*[[sum({*r[:i]}&{*r[i:]})or c for i,c in enumerate(r)]for r in a])];p=lambda g:f(f(g))