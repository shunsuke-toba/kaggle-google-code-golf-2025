f=lambda a:[*zip(*[[(*({*r[:i]}&{*r[i:]}-{0}),c)[0]for i,c in enumerate(r)]for r in a])];p=lambda g:f(f(g))