def p(g):
 for _ in g:
  g=*map(list,zip(*g[::-1])),;b=p=g[6][0]==2
  for h in p*g[::8in g[0]or-1]:h[p:=p-b or h.index(8)]|=3>>h[p];b-=h[p-1]
 return g