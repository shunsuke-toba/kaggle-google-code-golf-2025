def p(g):
 for S in[(2,4)]*24:z=g[:1];*g,=zip(*[[ (c,4)[c^2and l in S and(n in S or u in S)]for c,l,n,u in zip(r,[0,*r],[*r[1:],0],a)]for a,r in zip(z+g,g)][::-1])
 return g