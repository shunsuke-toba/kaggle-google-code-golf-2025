def p(g):
 for _ in[0]*24:*g,=zip(*[[ (c,4)[c^2and(20>>l&1)and(20>>n|20>>u)%2]for c,l,n,u in zip(r,[0,*r],[*r[1:],0],a)]for a,r in zip(g[:1]+g,g)][::-1])
 return g