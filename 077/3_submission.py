def p(g,e=enumerate):
 for S in[(2,4)]*24:g=[*zip(*[[(v,4)[v^2and r[j-(j>0)]in S and(r[j+1:]and r[j+1]in S or g[i-(i>0)][j]in S)]for j,v in e(r)]for i,r in e(g)][::-1])]
 return g