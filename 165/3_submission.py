p=lambda g:[*zip(*map(lambda*c:c[:20-(f:=~bytes(c).rfind(max(map(min,b:=sum(g,[]),b[17:],b[21:])))%20)]+f*(max(c[-f:]),),*g))]