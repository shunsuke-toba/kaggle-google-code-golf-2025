def p(g,f=filter):
 for b in sum(g,[]):
  if len({*(h:=[*zip(*f(any,zip(*f(any,[[b*(0<d!=b) for d in r]for r in g]))))])})<4<b+4:k=len(h)//3;return[r[::k]for r in h[::k]]