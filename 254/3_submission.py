def p(g):*t,=zip(*g);return[[-c&(h<sorted({*t})[2])*2+(h==max(t))for c,h in zip(r,t)]for r in g]