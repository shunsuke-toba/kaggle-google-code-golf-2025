p=lambda g:exec("g[:]=zip(*(map(min,r,map(max,r[1:]+[0],[0]+r))for*r,in g));"*2)or g