p=lambda g,h=lambda g:[*zip(*(map(lambda a,b,c:a&(b|c),r,r[1:]+[0],[0]+r)for*r,in g))]:h(h(g))