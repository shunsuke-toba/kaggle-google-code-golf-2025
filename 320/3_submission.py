p=lambda g:[*zip(*[(c[:-(s:=sum(c)>>2)]or c)+(8,)*s for c in zip(*g)])]