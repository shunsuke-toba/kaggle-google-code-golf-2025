p=lambda g:exec('''a=d=y=0;l=[]
for r in g:
 x=0
 for p in r:
  if p:l or(c:=x);a=a or~y;B=b=y;d=max(d,x);l+={p}-{8,*l}
  x+=1
 y+=1
while~a<=b:
 x=c
 while x<=d:g[b][x]=l[~a<b<B>=c<x<d];x+=1
 b-=1''')or g