import re;p=lambda g,k=119:-k*g or p(eval(re.sub((s:='([^0](, [^0]){%d})(.{%d})'%(c:=k//40+2,(len(g)-c)*3+1))+s+'(?=.*8)[08](, [08]){%d}'%c,r'\1\3\1\6\4',str([*zip(*g[::-1])]))),k-1)