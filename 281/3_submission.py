p=lambda g:exec('''a=d=y=0;l=[]
for r in g:
 x=0
 for p in r:
  if p:l or(c:=x);a=a or~y;B=b=y;d=max(d,x);l+={p}-{8,*l}
  x+=1
 y+=1
s=l[:1]
while~a<=b:g[b][c:d+1]=s+[l[~a<b<B]]*(d+~c)+s;b-=1''')or g