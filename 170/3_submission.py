p=lambda g:(e:=enumerate,b:=max(i for i,r in e(g)if any(r)),C:=[j for j,v in e(g[b])if v],c:=C[0],R:=range(n:=len(C)),a:=b-n+1,S:=[(i,j)for i,r in e(g)for j,v in e(r)if v and not(a<=i<a+n and c<=j<c+n)],t:=min(S)[0],s:=(max(S)[0]-t+1)//n,l:=min(j for _,j in S),[[g[t+y*s][l+x*s]and g[a+y][c+x]for x in R]for y in R])[-1]
