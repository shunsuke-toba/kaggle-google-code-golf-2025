p=lambda g:(e:=enumerate,s:=[(j,b:=i)for i,r in e(g)for j,v in e(r)if v],n:=sum(map(bool,g[b])),m:=(s[~n**2][1]-(t:=s[0][1])+1)//n,r:=range(n))and[[g[t+u*m][min(s[:-n*n])[0]+v*m]and g[b-n-~u][s[v-n][0]]for v in r]for u in r]