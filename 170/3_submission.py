p=lambda g:(r:=range,E:=enumerate,m:=min,M:=max,x:=next,d:=M(r(1,10),key=sum(g,[]).count),p:=zip(*[(i,j)for i,R in E(g)for j,v in E(R)if 0<v!=d]),a:=m(t:=x(p)),n:=M(t)-a+1,c:=m(t:=x(p)),c:=c-m(n-M(t)+c-1,c),q:=zip(*[(i,j)for i,R in E(g)for j,v in E(R)if v==d and not(a<=i<n+a and c<=j<c+n)]),h:=m(t:=x(q)),s:=(M(t)-h+1)//n,k:=m(x(q)),[[g[a+i][c+j]*(g[h+i*s][k+j*s]==d)for j in r(n)]for i in r(n)])[-1]
