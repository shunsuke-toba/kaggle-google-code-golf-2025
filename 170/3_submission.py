p=lambda g:(e:=enumerate,s:=[(b:=i,j)for i,r in e(g)for j,v in e(r)if v],n:=sum(map(bool,g[b])),m:=(s[~n**2][0]-(t:=s[0][0])+1)//n,r:=range(n))and[[g[t+u*m][min(j for i,j in s[:-n*n])+v*m]and g[b-n-~u][s[v-n][1]]for v in r]for u in r]