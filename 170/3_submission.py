p=lambda g:(R:=range,E:=enumerate,m:=min,M:=max,X:=next,d:=M(R(1,10),key=sum(g,[]).count),P:=[(i,j)for i,r in E(g)for j,v in E(r)if 0<v!=d],P:=zip(*P),a:=m(t:=X(P)),b:=M(t),c:=m(t:=X(P)),e:=M(t),n:=b-a+1,c:=c-(t:=m(o:=b-a-e+c,c)),e:=e+o-t,P:=[(i,j)for i,r in E(g)for j,v in E(r)if v==d and not(a<=i<=b and c<=j<=e)],P:=zip(*P),h:=m(t:=X(P)),s:=(M(t)-h+1)//n,k:=m(X(P)),[[g[a+x][c+y]*(d in{g[h+x*s+w//s][k+y*s+w%s]for w in R(s*s)})for y in R(n)]for x in R(n)])[-1]
