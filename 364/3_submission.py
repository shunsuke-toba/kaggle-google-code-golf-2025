p=lambda g,i=28,h=28*[0]:i and p([*zip(*[(h:=[[c.bit_count()*5%14%9,u|c|(u>0<l)*4<<i%4][i*c>c]for u,c,l in zip(h,b,[0,*b])])for b in g][::-1])],i-1)or g