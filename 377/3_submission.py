def p(g):x=();h=[(x:=r)for r in g if x!=r];return h*(g==h)or p([*zip(*h)])