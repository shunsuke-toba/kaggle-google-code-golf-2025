p=lambda g:g==(h:=[r[0]and[r[0]]*len(r)or r for r in g])and[*zip(*p(zip(*g)))]or h