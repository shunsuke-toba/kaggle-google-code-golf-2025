p=lambda g,k=lambda g:[r[0]and[r[0]]*len(r)or r for r in g]:[k(g),[*zip(*k(zip(*g)))]][g==k(g)]
