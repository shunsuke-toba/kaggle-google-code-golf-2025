def p(g):k=sum(2in r for r in g);t=[2]*k;k//=3;return t,*([2,*r,2]for r in zip(*sum(((c,)*k for c in zip(*g)if-3&max(c)),()))if max(r)&-3for _ in[0]*k),t