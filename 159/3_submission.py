def p(g):k=sum(2in r for r in g);t=[2]*k;f=lambda g:[c for c in zip(*g)if max(c)&-3];k//=3;r=range(3*k);return t,*[[2,*[f(f(g))[i//k][j//k]for j in r],2]for i in r],t