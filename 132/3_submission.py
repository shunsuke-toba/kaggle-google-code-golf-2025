p=lambda g,h=lambda g:[(c:=0,[(c:=c^x)or x for x in r])[1]for r in zip(*g)]:h(h([[sum({*r}&{*c})for c in zip(*g)]for r in g]))