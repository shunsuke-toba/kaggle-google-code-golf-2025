p=lambda g:[*map(l:=lambda r,c=0:[(c:=c^x)|x for x in r],zip(*[l(sum({*r}&{*c})for r in g)for c in zip(*g)]))]