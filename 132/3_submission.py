p=lambda g,l=lambda r,c=0:[(c:=c^x)|x for x in r]:[*map(l,zip(*[l([sum({*r}&{*c})for r in g])for c in zip(*g)]))]