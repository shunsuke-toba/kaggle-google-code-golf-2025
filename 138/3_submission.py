def p(g,e=enumerate):
 T,B=[i for i,r in e(g)if min(r)];L,R=[i for i,c in e(zip(*g))if min(c)];f=lambda A:[*zip(*[[x or(r[0]in r[j:])*r[0]|(r[-1]in r[:j])*r[-1]for j,x in e(r)]for r in A])];return f(f(r[L:R+1]for r in g[T:B+1]))