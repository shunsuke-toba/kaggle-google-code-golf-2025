p=lambda g,i=8:0in g[0]and p(g[1:],i)or i and p([*zip(*(i<5and[[(c,r[0])[r[0]in r[j:]]for j,c in enumerate(r)]for r in g]or g))][::-1],i-1)or g