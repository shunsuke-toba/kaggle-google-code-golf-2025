p=lambda g,f=lambda a:zip(*[[x or 8*(1in{*r[:j]}&{*r[j:]})for j,x in enumerate(r)]for r in a]):[*f(f(g))]