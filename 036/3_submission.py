def p(g):f=lambda a:zip(*filter(lambda r,s=sum(g,[]):max(s,key=lambda x:s.index(x)+s[::-1].index(x))in r,a));return[*map(list,f(f(g)))]