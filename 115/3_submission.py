p=lambda g,d={}.fromkeys:(k:=[*d(sum(g,[]))])[0]^g[0][-1]and[k]or[*zip(k)]
