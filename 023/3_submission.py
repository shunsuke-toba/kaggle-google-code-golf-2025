p=lambda g,e=enumerate:(f:=lambda s:not s or any(f(s-p)*[g[t>>4].__setitem__(t&15,2+6*(a<b))for t in p]for a in(1,16)for b in(a,16)if(p:={m:=min(s),m+a,m+b,m+a+b})<=s))({i<<4|j for i,r in e(g)for j,c in e(r)if c})and g