def p(g):l=max(g[0]);Z=zip;R,C=map(lambda m:[i for i,x in enumerate(m) if{*x}-{0,l}],(g,Z(*g)));return [[(v:=g[a][b])*(v==g[a][d]==g[c][b]==g[c][d]!=l)for b,d in Z(C,C[1:])]for a,c in Z(R,R[1:])]