p=lambda g,i=4:i and p([t[:(j:=t[3]<2)]+t[j:j+7][::2-len({*t})|1]+t[j+7:]for t in zip(*g[::-1])],i-1)or g