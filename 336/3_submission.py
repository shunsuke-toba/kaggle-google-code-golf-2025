f=lambda a:[*zip(*[[r[j]or 8*((5in{*r[:j]}&{*r[j:]})+(r.count(5)<2)*(5in r[(j<5)*5:10-(j>4)*5]))for j in range(10)]for r in a])];p=lambda g:f(f(g))