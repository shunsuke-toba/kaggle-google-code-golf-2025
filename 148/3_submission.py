def p(g):
 for a,b in zip(p:=[*filter(any,g)],p[len(p)//2:]):
  if 8in a:a[j:=a.index(8)]=4;f=a<b;b[:]=[8-r*3for r in b];a[f*j+1:-f|j]=b[1:j^-f]
 return g