p=lambda g:(lambda d,t:(s:=max(t,key=t.count))and([[v]*d for v in s[1]]if s[0]else[s[1]]*d))(len({j for r in g for j,x in enumerate(r)if x==5}),[(k,s)for k,a in((0,g),(1,zip(*g)))for b in a if(s:=[v for v in b if v])])
