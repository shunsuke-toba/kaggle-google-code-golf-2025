p=lambda g:(t:=len({*g[0]+g[-1]})>3,h:=[c:=[s.pop()for r in[g,zip(*g)][t]if(s:={*r}-{0,5})]]*len(c),[*zip(*h)],h)[2+t]