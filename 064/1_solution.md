# Task 064: 最大矩形からの線延長

## 問題の考察ポイントと解き方

### 考察ポイント

1. **背景色の特定**

   - グリッド内で最も頻繁に出現する色が背景色
   - この色は塗りつぶしの対象となるが、ブロックとしては扱わない

2. **矩形ブロックの認識**

   - 同一色で塗りつぶされた長方形領域を全て検出
   - 1x1 のブロックは矩形として扱わない（幅または高さが 2 以上必要）

3. **最大サイズ矩形の選択**

   - 検出した全矩形の中から面積が最大のものだけを選択
   - 最大サイズが複数ある場合は全て処理対象とする

4. **線延長時の停止条件**

   - 背景色以外の色にぶつかった場合：その位置を記録
   - グリッドの端に到達した場合：塗りつぶし不要

5. **塗りつぶしルール**
   - 延長線上で最後に見つけた非背景色の位置までを、その色で塗りつぶす
   - 背景色のセルのみが塗りつぶし対象

### 解くための手続き

1. **背景色の判定**

   - 全セルの色をカウントし、最頻出色を背景色として特定

2. **矩形の検出**

   - 各座標を起点として、同一色が連続する最大の矩形を探索
   - 右方向に拡張後、下方向に拡張して矩形を形成
   - 訪問済み座標は記録してスキップ

3. **最大矩形の選択**

   - 検出した矩形から面積（幅 × 高さ）を計算
   - 最大面積の矩形のみをフィルタリング

4. **4 方向への線延長処理**

   - 各最大矩形について、4 辺から外側に向けて処理：
     - **上方向**: 上辺の各列から上に向かって延長
     - **下方向**: 下辺の各列から下に向かって延長
     - **左方向**: 左辺の各行から左に向かって延長
     - **右方向**: 右辺の各行から右に向かって延長

5. **線延長の実装**

   - 各方向に 1 セルずつ進み、経路を記録
   - 背景色以外の色を見つけたら、その色と位置を記録
   - グリッド端に到達したら処理終了

6. **塗りつぶし処理**
   - 記録した経路上で、最後に見つけた非背景色の位置より手前の背景色セルを塗りつぶす
   - 塗りつぶす色は、最後に見つけた非背景色
