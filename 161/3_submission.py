p=lambda g:[[sum({r[0],u}&{min(s:=sum(g,[]),key=s.count)})for u in g[0]]for r in g]