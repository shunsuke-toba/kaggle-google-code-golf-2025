def p(g):o=max(f:=sum(g,[]),key=bool);return[[[c[0],[sum({*f})-o,o][c[0]>0]][0<r.count(o)<4 or 0<c.count(o)<4]for c in zip(r,*g)]for r in g]