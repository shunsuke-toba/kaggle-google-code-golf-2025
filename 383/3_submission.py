def p(g):_,o,p={}.fromkeys(sum(g,[]));return[[[(p,o)[x>0],x][r.count(o)^3>1<c.count(o)^3]for x,*c in zip(r,*g)]for r in g]