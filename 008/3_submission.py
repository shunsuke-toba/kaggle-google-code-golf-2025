p=lambda g:exec("i=f=0;g[:]=zip(*g[::-1])\nwhile~(m:=max(g[i]))&2:f>m and g.append(g.pop(i));i+=m>=f;f|=m>7\n"*4)or g