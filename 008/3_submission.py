def p(g):
 k=i=f=0
 while k<4:
  if(m:=max(g[i]))<f:g+=g.pop(i),
  i+=f<=m;f+=m>7
  if m&3:g=[*zip(*g[::-1])];k+=1;i=f=0
 return g