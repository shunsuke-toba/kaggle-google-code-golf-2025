p=lambda g:(lambda h=len(g),w=len(g[0]),a=[(i,j)for i,r in enumerate(g)for j,c in enumerate(r)if c]:(lambda f:min(f(h-1,w-1),f(h,w),key=lambda x:x[0])[1])(lambda S,T:(r:=[u[:]for u in g],l:=[r[x].__setitem__(y,2)for i,j in a if 0<=(x:=S-i)<h and 0<=(y:=T-j)<w and r[x][y]<1],(len(l),r))[2]))()
