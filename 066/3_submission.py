def p(g):n=len(g);(a,b),(c,d)=[divmod(i,n)for i in range(n*n)if g[i//n][i%n]==3];f=lambda y,x,a,b,t=2:0<=(Y:=y+a)<n>(X:=x+b)>=0 and((v:=g[Y][X])==2 or 7<v>t>0 and(f(y,x,b,-a,t-1)|f(y,x,-b,a,t-1)) or 8>v and f(Y,X,a,b,t)and(g[Y].__setitem__(X,3)or 1));g[2*a-c][2*b-d]^8and f(a,b,a-c,b-d)or f(c,d,c-a,d-b);return g