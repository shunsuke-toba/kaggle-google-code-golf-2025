def p(g):s=sum(g,[]);c,b,_=sorted({*s},key=s.count);f=lambda a:zip(*filter(lambda r:b in r,a));h=lambda a:[*zip(*[*a+[[0]*3]*(len(a)<3*all(a[0]))][::-1])];return[[x or c for x in r]for r in h(h(h(h([*f(f(g))]))))]