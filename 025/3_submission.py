def p(g):
 o=[[0]*len(r)for r in g]
 for x,k in enumerate(t:=[*zip(*g)]):
  if{*k}<{0,c:=k[0]}:
   for r,q in zip(g,o):q[x]=q[x+(c in r[x+1:])-(c in r[:x])]=c
 return o*any(o[0])or[*zip(*p(t))]