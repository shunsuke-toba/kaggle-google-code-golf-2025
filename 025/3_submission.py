def p(g):t=*zip(*g),;m=0,*map(min,t),0;return any(m)and[[m[x+1]+(m[x]in r[x:])*m[x]+(m[x+2]in r[:x])*m[x+2]for x in range(len(r))]for r in g]or[*zip(*p(t))]