p=lambda g:[[*map(max,*(t for t in g if sum(0<a!=b>0for a,b in zip(r,t))<1))]for r in g]