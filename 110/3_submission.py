p=lambda g:[[*map(max,*(t for t in g if 1>any(a*b*(a-b)for a,b in zip(r,t))))]for r in g]