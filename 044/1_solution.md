# Task 044: ブロックの形状マッチングと移動

# 問題の考察ポイントと解き方

## 考察ポイント

1. **グレー(5)で囲まれた黒(0)の領域の識別**

   - 黒(0)の連結成分を見つける
   - その連結成分の周囲（上下左右の隣接セル）が全てグレー(5)であることを確認
   - 複数の黒い領域が存在し、それぞれ異なる形状を持つ

2. **色付きブロックの条件**

   - 黒(0)とグレー(5)以外の色で構成される連結成分
   - 重要：同じ色でも複数の連結成分に分かれている場合、その色は移動対象外
   - 連結成分が 1 つだけの色のみが移動対象となる

3. **形状のマッチング**
   - ブロックの絶対位置ではなく、相対的な配置（形状）で判定
   - 回転や反転は考慮しない（完全一致のみ）
   - 各色付きブロックには必ず対応する黒い領域が存在

## 解くための手続き

1. **前処理：連結成分の探索**

   - グリッド全体を DFS または BFS で走査
   - 訪問済みフラグを管理して重複探索を避ける

2. **黒い領域の収集**

   - 黒(0)の連結成分を見つける
   - 各連結成分について、全ての境界セルがグレー(5)かチェック
   - 条件を満たす領域をリストに保存

3. **色付きブロックの収集**

   - 黒(0)とグレー(5)以外の色の連結成分を探索
   - 色ごとに連結成分の数をカウント
   - 連結成分が 1 つだけの色のブロックを収集

4. **形状の正規化**

   - ブロックの座標リストから最小の y 座標と x 座標を求める
   - 全ての座標から最小値を引いて、原点からの相対座標に変換
   - ソートして比較可能な形式にする

5. **マッチングと移動**

   - 各色付きブロックの正規化形状を計算
   - 各黒い領域の正規化形状と比較
   - 一致するペアが見つかったら：
     - 元のブロック位置を黒(0)でクリア
     - 黒い領域の位置に色付きブロックの色を配置
     - 位置の調整は最小座標の差分で計算

6. **結果の出力**
   - 変更を適用した新しいグリッドを返す
