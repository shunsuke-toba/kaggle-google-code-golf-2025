p=lambda g:len({0,*g[0]})>2and[*zip(*p([*zip(*g)]))]or[[*map(min,*(t for t in g if max(t)==max(r)))]for r in g]