p=lambda g:(lambda t,f:(G:=g if(H:=f(g)>=f(zip(*g)))else t(g),d:={},[d.setdefault(next(filter(None,r),0),set()).update(i for i,x in enumerate(r)if x<1)for r in G],[r.__setitem__(i,0)for r in G for i in d[next(filter(None,r),0)]],H and G or t(G))[4])(lambda a:[*map(list,zip(*a))],lambda x:sum(len({*r}-{0})<2 for r in x))
