p=lambda g:len({0,*g[0]})>2and[*zip(*p([*zip(*g)]))]or[[*map(min,*filter({max(r)}.issubset,g))]for r in g]