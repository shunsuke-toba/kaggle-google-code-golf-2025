p=lambda g:len({0,*g[0]})>2and[*zip(*p([*zip(*g)]))]or[[v*all(max(s)^v|s[i]for s in g)for i,v in enumerate(r)]for r in g]