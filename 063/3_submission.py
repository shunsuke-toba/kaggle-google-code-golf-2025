p=lambda g:[[t[0]or(max(r[1:-1])*max(t)<1)*3for t in zip(r,*g[1:-1])]for r in g]