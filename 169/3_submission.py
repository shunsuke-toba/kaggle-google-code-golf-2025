p=lambda g,t=20,e=8:t and p([*zip(*[[[v.bit_count()*6%7,v|n|(v<6)*(e:=e*2)][t*v>v]for v,n in zip(R,(0,*R))]for R in g[::-1]])],t-1)or g