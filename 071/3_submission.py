p=lambda g,a=0:[[v and(a or{t:=i-r[::-1].index(a:=v)})and(r[~i+t],v)[v==a] for i,v in enumerate(r)]for r in g]