def p(g):
 r=[[],[],[]];o=e=3;s=[]
 for t in*zip(*g),[0]*3:
  if sum(t):s+=t,
  elif s:o+=(*s[0],5).index(5)-e;e=(*s[-1],5).index(5);[r[y-o%3].append(c[y]and sum({*sum(s,())})-5)for c in s for y in(0,1,2)];s=[]
 return r