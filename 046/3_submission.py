def p(g):
 r=[[],[],[]];o=e=3;s=[]
 for t in*zip(*g),():
  if sum(t):s+=t
  elif s:o+=min(s.index(5),3)-e;[r[i%3-o%3].append(v and sum({*s})-5)for i,v in enumerate(s)];e,*s=(*s[-3:],5).index(5),
 return r