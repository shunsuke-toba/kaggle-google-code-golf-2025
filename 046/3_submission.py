def p(g):
 r=[[],[],[]];o=e=3;s=[]
 for t in*zip(*g),():
  if sum(t):s+=t,
  elif s:o+=(*s[0],5).index(5)-e;[r[y-o%3].append(c[y]and sum({*sum(s,())})-5)for y in(0,1,2)for c in s];e,*s=(*s[-1],5).index(5),
 return r