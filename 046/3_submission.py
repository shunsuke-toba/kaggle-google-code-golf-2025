def p(g):
 r=[],[],[];o,e=2,3;s=[]
 for t in*zip(*g),():
  if sum(t):b=(t+(5,)).index(5);s or(a:=b);s+=t
  elif s:o-=a-e;[r[(o:=o+1)%3].append(v and sum({*s})-5)for v in s];e,*s=b,
 return r