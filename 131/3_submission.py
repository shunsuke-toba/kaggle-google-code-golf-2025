p=lambda g:(w:=len(g[0]))>(l:=len(g))and[*zip(*p([*map(list,zip(*g))]))]or(r:=g.index([2]*w),h:=[r for r in g[r+1:] if 3in r],h and (g[:r+1]+h+[[8]*w]+g[:1]*l)[:l] or p(g[::-1])[::-1])[2]