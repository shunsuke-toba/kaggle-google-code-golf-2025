p=lambda g:(l:=len(g))<6and[*zip(*p([*zip(*g)]))]or(h:=[*filter(any,g[(r:=-~[*map(max,g)].index(2)):])])and(g[:r]+h+[[8]*len(h[0])]+g[:1]*l)[:l]or p(g[::-1])[::-1]