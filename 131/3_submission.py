t=lambda a:[*map(list,zip(*a))]
p=lambda g:(w:=len(g[0]))>len(g)and t(p(t(g)))or((r:=g.index([2]*w)),(h:=[x for x in g if 3 in x]),h[0]in g[:r]and p(g[::-1])[::-1]or g[:r+1]+h+[[8]*w]+g[:1]*(len(g)-r-len(h)-2))[-1]