t=lambda a:[*map(list,zip(*a))]
p=lambda a:(w:=len(a[0]))>len(a)and t(p(t(a)))or((r:=a.index([2]*w)),(g:=[x for x in a if 3 in x]),g[0]in a[:r]and p(a[::-1])[::-1]or a[:r+1]+g+[[8]*w]+[[0]*w]*(len(a)-r-len(g)-2))[-1]