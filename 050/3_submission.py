p=lambda g:exec("g[:]=zip(*[[v|3*(8in r[:i])*(8in r[i+1:])for i,v in enumerate(r)]for r in g]);"*2)or g