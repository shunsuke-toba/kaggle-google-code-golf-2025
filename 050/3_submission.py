p=lambda g,h=lambda g:[((s:=0)or[max(v,(s:=s^v//8)*3)for v in r],r)[s]for r in zip(*g)]:h(h(g))