p=lambda g,t=8,e=8:t and p(zip(*[(m:=5)and[m:=-(t<2<5<v)&6-v.bit_count()or v|(v<5)*(e:=e+e)|m*(v!=5)for v in R]for R in g][::-1]),t-1)or[*g]