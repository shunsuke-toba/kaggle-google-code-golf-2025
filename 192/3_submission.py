p=lambda g,e=enumerate:[[(c:=max(range(1,10),key=sum(g,[]).count))*(c in r[:j+2][-3:]*r[j])*(c in t)for j,t in e(zip(*g[:i+2][-3:]))]for i,r in e(g)]