import re;p=lambda g,k=39:-k*g or p(eval(re.sub('(([12], |^[^1]*)1[^)]*)0(?=(%s..)*%s.1|[^)]*[12])'%(('.'*len(g)*3,)*2),r'\1 2',f'{*zip(*g[::-1]),}')),k-1)